---
title: "RWorksheet_Mijares#5.Rmd"
author: "Jason LLoyd C. Mijares"
date: "2024-11-06"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(rvest)
library(httr)
library(dplyr)
library(polite)
library(kableExtra)
library(stringr)


url <- 'https://www.imdb.com/chart/toptv'

page <- read_html(url)

session <- bow(url, user_agent = "Educational")

session
```
```{r}
name <- page %>% html_nodes(".ipc-title__text") %>% html_text()
name1 <- name[!grepl("Top 250 TV Shows|IMDb Charts|Recently viewed|More to explore", name, ignore.case = TRUE)]
name1
```
```{r}
rank <- str_extract(name1, "^\\d+\\.")
rank
```


```{r}
title <- str_replace(name, "^\\d+\\.", "")
title
```


```{r}
year = page %>% html_nodes(".sc-5bc66c50-6.OOdsw.cli-title-metadata-item") %>% html_text()
years <- str_extract_all(year, "\\b\\d{4}(?:â€“\\d{4})?\\b") %>% unlist()
years
```


```{r}
ratings = page %>% html_nodes(".ipc-rating-star--rating") %>% html_text()
ratings
```


```{r}
episode <- page %>% html_nodes(".sc-5bc66c50-6.OOdsw.cli-title-metadata-item") %>%
html_text()
episodes <- str_extract_all(episode, "\\b\\d+ eps\\b") %>% unlist()
episodes
```

```{r}
votes = page %>% html_nodes(".ipc-rating-star--voteCount") %>% html_text()
votes
```
```{r}
max_length <- max(length(rank), length(title), length(year), length(ratings), length(episodes), length(votes))
rank <- c(rank, rep(NA, max_length - length(rank)))
title <- c(title, rep(NA, max_length - length(title)))
year <- c(year, rep(NA, max_length - length(year)))
ratings <- c(ratings, rep(NA, max_length - length(ratings)))
episodes <- c(episodes, rep(NA, max_length - length(episodes)))
vote <- c(vote, rep(NA, max_length - length(vote)))
max_length
```
```{r}
movies = data.frame(rank, title, year, ratings, episodes, vote, stringsAsFactors = FALSE)

head(movies,10)

movies %>%
  kable("latex", booktabs = TRUE) %>%
  kable_styling(latex_options = "scale_down")
```

